"""
SOURCE: https://github.com/HubFire/Muti-branch-DDPG-CARLA/blob/master/environment/carla_config.py
"""
from carla import sensor
from carla.settings import CarlaSettings
import random
"""
Example of dataset configuration. 
"""
# The image size definition for the cameras
WINDOW_WIDTH  = 800
WINDOW_HEIGHT = 600

#Positions a vector of tuples containing the [START, END] positions
#of the episodes that the (expert driver)[docs/agent_module.md] is going to follow. The
#possible positions for agent placement can be viewed by running
POSITIONS = [[71, 127], [21, 116],  [51, 49], [35, 110], [91, 85],
             [93, 114], [7, 30], [133, 110], [43, 60], [98, 11], [49, 96], [85, 90],
             [40, 27], [74, 37], [41, 97], [62, 110], [2, 19], [114, 138], [76, 131],
             [95, 116], [71, 50], [97, 15], [74, 71], [133, 50],
             [116, 23], [116, 38], [52, 101], [108, 5], [79, 23], [68, 13]]
# The FOV for all the cameras
FOV = 100
# The frequency where all the the camera will be colleted. 1 means every frame, 0.5 every two frames
sensors_frequency = {'CameraRGB': 1}
# The yaw of every sensor.
sensors_yaw = {'CameraRGB': 0}
# The percentage of episodes to have lateral noise. More information about the noise can
# be found at docs/agent_module.md
lat_noise_percent = 0
# The percentage of episodes with longitudinal noise.
long_noise_percent = 0
# The interval of vehicles/pedestrians that every episode can have

NumberOfVehicles    = [30, 60]  # The range for the random numbers that are going to be generated
NumberOfPedestrians = [50,100]

set_of_weathers = [1, 3, 6, 8]

"""
Returns the entire CarlaSettings to be used on all the episodes.
Here we are defining the cameras used. The number of vehicles and pedestrians will 
be sampled from the interval defined on the NumberOfVehicle and NumberOfPedestrians variables.
This function must be redefined on each of the daset cofiguration files.
"""

def make_carla_settings():
    """Make a CarlaSettings object with the settings we need."""

    settings = CarlaSettings()
    settings.set(
        SendNonPlayerAgentsInfo=False,
        SynchronousMode=True)
    settings.set(DisableTwoWheeledVehicles=True)

    settings.randomize_seeds()
    # Add a carla camera.
    camera0 = sensor.Camera('CameraRGB')
    camera0.set_image_size(WINDOW_WIDTH, WINDOW_HEIGHT)
    camera0.set(FOV=FOV)
    camera0.set_position(2.0, 0.0, 1.4)
    camera0.set_rotation(-15.0, 0, 0)
    settings.add_sensor(camera0)

    return settings

def poses_town01():
    """
    Each matrix is a new task. We have all the four tasks
    """

    def _poses_straight():
        return [[ 36, 40],[ 39, 35], [110, 114], [7, 3], [0, 4],
                [ 68, 50],[ 61, 59], [47, 64], [147, 90], [33, 87],
                [ 26, 19],[ 80, 76], [45, 49], [55, 44], [29, 107],
                [ 95,104],[ 84, 34], [53, 67], [22, 17], [91, 148],
                [ 20,107],[ 78, 70], [95, 102], [68, 44], [45, 69]]

    def _poses_one_curve():
        return [[138, 17],[ 47, 16],[ 26,  9],[ 42, 49],[140,124],
                [ 85, 98],[ 65,133],[137, 51],[ 76, 66],[ 46, 39],
                [ 40, 60],[  0, 29],[  4,129],[121,140],[  2,129],
                [ 78, 44],[ 68, 85],[ 41,102],[ 95, 70],[ 68,129],
                [ 84, 69],[ 47, 79],[110, 15],[130, 17],[  0, 17]]

    def _poses_navigation():
        return [[105, 29], [27, 130], [102, 87], [132, 27], [24, 44],
                [96, 26], [34, 67], [28, 1], [140, 134], [105, 9],
                [148, 129], [65, 18], [21, 16], [147, 97], [42, 51],
                [30, 41], [18, 107], [69, 45], [102, 95], [18, 145],
                [111, 64], [79, 45], [84, 69], [73, 31], [37, 81]]

    return [_poses_straight(), _poses_one_curve(), _poses_navigation(), _poses_navigation()]

def poses_town02():
    def _poses_straight():
        return [[38, 34], [4, 2], [12, 10], [62, 55], [43, 47],
                [64, 66], [78, 76], [59, 57], [61, 18], [35, 39],
                [12, 8], [0, 18], [75, 68], [54, 60], [45, 49],
                [46, 42], [53, 46], [80, 29], [65, 63], [0, 81],
                [54, 63], [51, 42], [16, 19], [17, 26], [77, 68]]

    def _poses_one_curve():
        return [[37, 76], [8, 24], [60, 69], [38, 10], [21, 1],
                [58, 71], [74, 32], [44, 0], [71, 16], [14, 24],
                [34, 11], [43, 14], [75, 16], [80, 21], [3, 23],
                [75, 59], [50, 47], [11, 19], [77, 34], [79, 25],
                [40, 63], [58, 76], [79, 55], [16, 61], [27, 11]]

    def _poses_navigation():
        return [[19, 66], [79, 14], [19, 57], [23, 1],
                [53, 76], [42, 13], [31, 71], [33, 5],
                [54, 30], [10, 61], [66, 3], [27, 12],
                [79, 19], [2, 29], [16, 14], [5, 57],
                [70, 73], [46, 67], [57, 50], [61, 49], [21, 12],
                [51, 81], [77, 68], [56, 65], [43, 54]]

    return [_poses_straight(), _poses_one_curve(), _poses_navigation(), _poses_navigation()]

def test():
    all_pose = poses_town01()
    index = random.randint(0,3)
    pose  = random.choice(all_pose[index])
    print(pose)
